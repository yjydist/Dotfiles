import{$ as e,At as t,C as n,F as r,I as i,K as a,N as o,Ot as s,Q as ee,U as c,V as l,W as u,X as d,Y as f,et as p,ht as m,jt as h,lt as g,mt as _,q as v,st as y,tt as b,ut as x,x as S,xt as C,yt as w}from"./DO0JR7ER.js";import{s as te}from"./CnEnsHnL.js";import{T,f as E,i as D,w as O}from"./Dq3bNNT9.js";import{t as k}from"./BLNk-Hhf.js";import{n as A}from"./Ch85hcd-.js";import{p as j}from"./DwNTAuCO.js";import{t as M}from"./Dxsakos9.js";var N=[];for(let e=0;e<256;++e)N.push((e+256).toString(16).slice(1));function P(e,t=0){return(N[e[t+0]]+N[e[t+1]]+N[e[t+2]]+N[e[t+3]]+`-`+N[e[t+4]]+N[e[t+5]]+`-`+N[e[t+6]]+N[e[t+7]]+`-`+N[e[t+8]]+N[e[t+9]]+`-`+N[e[t+10]]+N[e[t+11]]+N[e[t+12]]+N[e[t+13]]+N[e[t+14]]+N[e[t+15]]).toLowerCase()}var F,I=new Uint8Array(16);function L(){if(!F){if(typeof crypto>`u`||!crypto.getRandomValues)throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);F=crypto.getRandomValues.bind(crypto)}return F(I)}var R={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function z(e,t,n){e||={};let r=e.random??e.rng?.()??L();if(r.length<16)throw Error(`Random bytes length must be >= 16`);if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n||=0,n<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return P(r)}function B(e,t,n){return R.randomUUID&&!t&&!e?R.randomUUID():z(e,t,n)}var V=B,H={class:`flex h-full items-center justify-center overflow-y-auto bg-gradient-to-b from-base-100 to-base-200 p-4`},U={class:`animate-fade-slide-in mx-auto w-full max-w-md`},W={class:`animate-fade-slide-in-delay-1 mb-8 text-center`},G={class:`mb-4`},ne={class:`shadow-primary-glow mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-primary to-secondary text-primary-content`},K={class:`text-[0.9375rem] text-base-content/60`},q={class:`shadow-card animate-fade-slide-in-delay-2 rounded-2xl border border-base-content/8 bg-base-200/80 p-6 backdrop-blur-md`},J={class:`flex flex-col gap-2`},Y={class:`flex items-center gap-2 text-sm font-medium text-base-content/70`,for:`url`},X={id:`defaultEndpoints`},Z=[`value`],re=[`value`],ie=[`value`],ae=[`value`],oe={class:`flex flex-col gap-2`},se={class:`flex items-center gap-2 text-sm font-medium text-base-content/70`,for:`secret`},ce={key:0,class:`animate-fade-slide-in-delay-3 mt-6`},le={class:`flex flex-col gap-3`},ue=[`onClick`],de={class:`flex h-7 w-7 shrink-0 items-center justify-center rounded-md bg-info/20 text-info`},fe={class:`min-w-0 flex-1 overflow-hidden text-[0.8125rem] font-medium text-ellipsis whitespace-nowrap text-base-content`},pe=[`onClick`],Q=k(b({__name:`setup`,setup(b){let{t:k}=S();o({title:a(()=>k(`setup`))});let N=i(),P=r(),F=n(),I=w({url:``,secret:``}),L=C(!1),R=a(()=>typeof window>`u`?``:window.__METACUBEXD_CONFIG__?.defaultBackendURL||`http://127.0.0.1:9090`),z=a(()=>typeof window>`u`?``:window.location.origin);function B(e){F.setSelectedEndpoint(e),N.replace(`/overview`)}async function Q(e){let t=F.endpointList.find(t=>t.id===e);t&&await A(t.url,t.secret)&&B(e)}async function $(){L.value=!0;try{let e=I.url,t=I.secret,n=j(e);if(!await A(n,t)){L.value=!1;return}let r=V(),i=[...F.endpointList],a=i.find(e=>e.url===n);if(!a){F.setEndpointList([{id:r,url:n,secret:t},...i]),B(r);return}a.secret=t,a.id=r,F.setEndpointList(i),B(r)}finally{L.value=!1}}function me(e){F.removeEndpoint(e)}return y(async()=>{let e=P.query||(typeof window<`u`?new URLSearchParams(window.location.search):null);if(e&&typeof e==`object`){let t=e.hostname;if(t){I.url=`${e.http?`http:`:e.https?`https:`:typeof window<`u`?window.location.protocol:`http:`}//${t}${e.port?`:${e.port}`:``}`,I.secret=e.secret||``,await $();return}}F.endpointList.length===0&&(I.url=R.value,I.secret=``,await $())}),(n,r)=>{let i=M;return g(),d(`div`,H,[v(`div`,U,[v(`div`,W,[v(`div`,G,[v(`div`,ne,[p(s(E),{size:32})]),r[2]||=ee(`<h1 class="text-3xl font-bold tracking-wide uppercase sm:text-4xl" data-v-9fff2891><span class="bg-gradient-to-br from-primary to-secondary bg-clip-text text-transparent" data-v-9fff2891>metacube</span><span class="text-base-content" data-v-9fff2891>(</span><a class="inline-block text-primary no-underline transition-all duration-300 hover:scale-110 hover:rotate-5" href="https://github.com/metacubex/metacubexd" target="_blank" data-v-9fff2891> xd </a><span class="text-base-content" data-v-9fff2891>)</span></h1>`,1)]),v(`p`,K,h(s(k)(`setupDescription`)),1)]),v(`div`,q,[v(`form`,{class:`flex flex-col gap-5`,onSubmit:c($,[`prevent`])},[v(`div`,J,[v(`label`,Y,[p(s(T),{size:16}),v(`span`,null,h(s(k)(`endpointURL`)),1)]),m(v(`input`,{id:`url`,"onUpdate:modelValue":r[0]||=e=>s(I).url=e,type:`url`,class:`w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none`,placeholder:`http(s)://{hostname}:{port}`,list:`defaultEndpoints`,autocomplete:`on`},null,512),[[l,s(I).url]]),v(`datalist`,X,[v(`option`,{value:s(te)},null,8,Z),s(R)&&s(R)!==s(`http://127.0.0.1:9090`)?(g(),d(`option`,{key:0,value:s(R)},null,8,re)):f(``,!0),s(z)&&s(z)!==s(`http://127.0.0.1:9090`)?(g(),d(`option`,{key:1,value:s(z)},null,8,ie)):f(``,!0),(g(!0),d(u,null,x(s(F).endpointList,e=>(g(),d(`option`,{key:e.id,value:e.url},null,8,ae))),128))])]),r[3]||=v(`input`,{type:`text`,name:`username`,autocomplete:`username`,class:`sr-only`,"aria-hidden":`true`,tabindex:`-1`},null,-1),v(`div`,oe,[v(`label`,se,[p(s(O),{size:16}),v(`span`,null,h(s(k)(`secret`)),1)]),m(v(`input`,{id:`secret`,"onUpdate:modelValue":r[1]||=e=>s(I).secret=e,type:`password`,class:`w-full rounded-lg border border-base-content/15 bg-base-100/80 px-4 py-3 text-[0.9375rem] text-base-content transition-all duration-200 placeholder:text-base-content/40 focus:border-primary focus:ring-3 focus:ring-primary/20 focus:outline-none`,placeholder:`secret`,autocomplete:`current-password`},null,512),[[l,s(I).secret]])]),p(i,{type:`submit`,class:`hover:shadow-primary-glow-lg w-full cursor-pointer rounded-lg border-none bg-gradient-to-br from-primary to-secondary px-6 py-3.5 text-[0.9375rem] font-semibold tracking-widest text-primary-content uppercase transition-all duration-300 hover:-translate-y-0.5`,loading:s(L)},{default:_(()=>[e(h(s(k)(`add`)),1)]),_:1},8,[`loading`])],32)]),s(F).endpointList.length>0?(g(),d(`div`,ce,[r[4]||=v(`h3`,{class:`mb-3 text-[0.8125rem] font-semibold tracking-widest text-base-content/50 uppercase`},` Saved Endpoints `,-1),v(`div`,le,[(g(!0),d(u,null,x(s(F).endpointList,(e,n)=>(g(),d(`div`,{key:e.id,class:`animate-fade-slide-in flex cursor-pointer items-center gap-2 rounded-xl border border-info/20 bg-info/10 p-3 transition-all duration-200 hover:-translate-y-0.5 hover:border-info/30 hover:bg-info/15`,style:t({animationDelay:`${n*50}ms`}),onClick:t=>Q(e.id)},[v(`div`,de,[p(s(E),{size:16})]),v(`span`,fe,h(e.url),1),v(`button`,{class:`flex h-6 w-6 shrink-0 cursor-pointer items-center justify-center rounded-full border-none bg-transparent text-base-content/50 transition-all duration-200 hover:bg-error/15 hover:text-error`,onClick:c(t=>me(e.id),[`stop`])},[p(s(D),{size:14})],8,pe)],12,ue))),128))])])):f(``,!0)])])}}}),[[`__scopeId`,`data-v-9fff2891`]]);export{Q as default};